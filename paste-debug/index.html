<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Paste debug – clipboard char inspector</title>
  <style>
    body { font-family: system-ui; padding: 20px; max-width: 800px; }
    #pasteTarget { border: 1px solid #ccc; min-height: 120px; padding: 12px; margin: 12px 0; }
    #output { font-family: monospace; font-size: 12px; white-space: pre-wrap; background: #f5f5f5; padding: 12px; }
    .line { margin: 4px 0; }
    .unmatched { background: #ffe0e0; }
  </style>
</head>
<body>
  <h1>Paste debug</h1>
  <p>Paste from Outlook in the box below. Character analysis will appear under it.</p>
  <div id="pasteTarget" contenteditable="true">Paste here…</div>
  <h2>Clipboard analysis</h2>
  <pre id="output">(paste to see)</pre>

  <script>
    const bulletChars = { '•': 0, '·': 0, 'o': 1, '§': 2, '▪': 3 };

    document.getElementById('pasteTarget').addEventListener('paste', (e) => {
      e.preventDefault();
      const html = e.clipboardData?.getData('text/html') || '';
      const text = e.clipboardData?.getData('text/plain') || '';
      const isMsOffice = html.includes('urn:schemas-microsoft-com:office');

      const lines = text.split('\n');
      const out = ['Raw text length: ' + text.length];
      out.push('MS Office detected: ' + isMsOffice);
      out.push('');

      lines.forEach((line, i) => {
        const trimmed = line.trim();
        if (!trimmed) return;
        const fc = trimmed[0];
        const cp = fc?.codePointAt?.(0);
        const hex = cp != null ? 'U+' + cp.toString(16).toUpperCase().padStart(4, '0') : '?';
        const matched = fc in bulletChars || (fc === 'o' && /^o\s/.test(trimmed));
        const prefix = matched ? '  ' : '!!';
        out.push(prefix + ' line ' + i + ': firstChar="' + fc + '" ' + hex + ' matched=' + matched);
      });

      document.getElementById('output').textContent = out.join('\n');
    });
  </script>
</body>
</html>
